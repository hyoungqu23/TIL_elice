# 0520

## [JWT](https://jwt.io/)

JSON Web Token의 약어로, 인증을 위한 정보를 특별한 저장소를 이용하지 않고 전자 서명을 이용하여 확인하는 방법을 의미한다. 데이터를 웹에서 사용하기 위한 스펙이므로, 웹에서 사용가능한 문자열로만 구성된 base 64 인코딩 방식을 활용한다.

- header: 토큰의 타입, 데이터 서명 방식
- payload: 전달되는 데이터

  payload의 경우 단순히 정보를 base64 방식으로 인코딩한 데이터로, 디코딩하면 정보가 노출되므로, 민감한 정보는 제외하고 토큰을 생성해야 한다.

  JWT는 payload에 따라 signature가 달라지므로, 사용자가 토큰을 변조할 수도 없다.

- signature: header, payload의 전자 서명

또한, 서버는 JWT를 생성할 때 비공개 키를 서명에 활용하므로, payload를 조작하더라도 서명이 일치하지 않으므로 인증에 실패하게 된다.

session은 기본적으로 웹 브라우저의 통신 스펙이므로 모바일 앱 등에서는 활용하기 부적합하므로, JWT를 활용해 어느 클라이언트에서나 동일한 방식의 사용자 인증을 구현할 수 있다.

## JWT with Cookie

Cookie란 웹 서비스에서 사용하는 정보를 클라이언트에 저장하고, HTTP 요청 시 이를 함께 전송해 클라이언트 정보를 서버에 전달하는 기술로, 클라이언트 정보를 서버 측 저장소에 저장하고 사용하는 Session과 반대된다. 또한, Cookie는 브라우저 저장소에 저장되기 때문에 서버의 상태와 관계없이 클라이언트가 쿠키의 내용을 유지할 수 있다.

JWT를 Cookie에 저장하는 경우 데이터베이스 접근이 줄어 효율적인 인증 구조를 구현할 수 있다. 로그인 로직에서 JWT를 생성하고 Cookie로 전달한 후 JWT 로그인 미들웨어를 추가하여 쉽게 구현할 수 있다. 또한, 로그아웃은 간단히 클라이언트 Cookie를 삭제하여 처리할 수 있다.(만료 시간을 0으로 설정)

## 비밀번호 찾기 기능

임의의 문자열로 비밀번호를 초기화하고, 이를 메일로 전달한 뒤, 첫 로그인 시 비밀번호 변경을 요청하는 페이지로 넘어가게끔 구현해야 한다.

### 메일 발송 기능

SMTP 서버를 통해 무료로 발송하는 방법과 메일 발송 서비스(SendGrid api, Mailgun api 등)를 이용하는 방법이 있다.

SMTP는 Simple Mail Transfer Protocol의 약어로, 메일 전송을 위한 표준 규약을 의미한다. 즉, SMTP 서버는 표준 규약을 통해 메일을 전송하는 기능을 구현한 서버이다. 다만, 직접 만드는 것은 비효율적이기 때문에 Nodemailer 패키지를 활용해 SMTP 서버를 구현하고, 이를 통해 메일을 발송할 수 있다.
dmgmqomkvvtlsapx

## OAuth

Open Authorization의 약어로, 서비스 제공자가 다른 서비스에게 데이터를 제공하기 위해 서비스 사용자에게 제공하는 사용자 인증방식의 표준을 의미한다.

서비스 제공자에게 인증 요청을 시작으로, 인증이 완료되면 사용자 정보를 요청한 서비스로 전달한다. 이후 인증 정보를 이용해 서비스 제공자의 데이터를 사용할 수 있다.

OAuth는 사용자의 인증을 제공하는 표준이므로, 로그인 기능을 간편하게 구성할 수 있다. 웹 서비스 제공자는 아이디, 비밀번호 로그인을 구현할 필요가 없고, 웹 서비스 사용자는 로그인 시 아이디, 비밀번호를 입력할 필요가 없다.

## SSR과 API의 차이

SSR은 서버에서 프로그램을 구현하는 것이고, API는 구현하지 않고 사양만을 가지고 있다는 것이 가장 큰 차이라고 생각한다.

SSR은 서버에서 사용자에게 보여줄 페이지를 모두 구현하고, 이를 사용자에게 보여주는 방식을 의미한다.

따라서, 모든 데이터가 구성되는 속도가 빠르고, SEO 등을 구성하기 쉽다는 장점이 있다. 다만, CSR보다 페이지 구성 속도가 느리고, 서버 리소스를 많이 사용한다는 단점이 있다.

API는 Application Programming Interface의 약어로, 프로그램을 구현하기 위한 일련의 정의, 프로토콜 등의 세트이다. 즉, API으로 정의된 프로그램의 사양을 바탕으로 프로그램을 구현할 수 있다.

> 서버 사이드 렌더링은 HTML 페이지를 화면에 띄우는 것이고, API를 만드는 것은 백엔드와 프론트엔드 사이에서 자원을 주고 받는 통로를 만드는 것입니다. Node.js에서는 PUG라는 템플릿 엔진을 이용해 HTML을 화면에 띄웠습니다. 반면 API를 만든다는 것은 res.json({ });을 이용해 JSON 형태로 데이터를 내보내는 것입니다. 이 둘의 차이가 무엇인지 잘 짚고 넘어가시기를 바랍니다.
